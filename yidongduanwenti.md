

### 2.2浮层

背景描述：<br/>
　　*小朱同学查了个人待收货信息，发现正在派送，连忙给女朋友挂个电话，告知快到了，女朋友瞬间就乐开了花。这是小朱朋友们都吃完了，准备打车回去。小朱同学打开某滴打算打个快车回家。在屏幕阅读器的帮助下，在手机界面上找到某滴的图标，双击打开了应用。小朱同学在触摸浏览界面的时候，却出现了奇怪的现象，出现了几个奇怪提示“某滴欢迎您”“有某滴一路畅通”“跳过”等等，双击却没有反应。小朱同学暂停读屏服务，在界面上划了几下，再打开读屏服务，发现奇怪的提示就不见了。小朱同学知道这是欢迎页的浮层，小朱同学只是郁闷，什么时候读屏能屏蔽底层视图，也能在读屏开启的情况下操作呢？*<br/>
#### 2.2.1浮层不能滑动浏览
![](/18.png)<br/>
图18 浮窗不能滑动浏览【示例】<br/>
【问题描述】<br/>
当一个浮层弹出后，不能滑动浏览进入浮层内； 在浮层内不能滑动浏览浮层内的控件；<br/>
【可能原因】<br/>
2、 PopupWindow内的控件没有设置焦点；<br/>
1、 PopupWindow没有获得焦点；<br/>
【修改建议】<br/>
android：<br/>
1、 把PopupWindow内的所有控件设置焦点；<br/>
2、 给PopupWindow设置焦点；<br/>
方法1： PopupWindow初始化的时候第四个参数设置为true；<br/>
方法2： 用setFocusable()函数设置PopupWindow获得焦点， 参数是true是获得焦点，参数是false是不获得焦点。<br/>
#### 2.2.2不能屏蔽底层的焦点
![](/19.png)<br/>
图19 不能屏蔽底层的焦点【示例】<br/>
【问题描述】<br/>
当浮层弹出后用单指在界面上滑动浏览， 朗读的是浮层底的控件没有朗读浮层内的控件；<br/>
【可能原因】<br/>
【修改建议】<br/>
android：<br/>
 给PopupWindow设置焦点：<br/>
方法1： PopupWindow初始化的时候第四个参数设置为true<br/>
方法2： 用setFocusable()函数设置PopupWindow获得焦点， 参数是true是获得焦点，参数是false是不获得焦点。<br/>
#### 2.2.3浮层无法关闭
![](/20.png)<br/>
图20 浮窗无法关闭【示例】<br/>
【问题描述】<br/>
在屏幕阅读器开启的情况下， 浮层弹出后， 没有提供任何一种方式关闭浮层。<br/>
【可能原因】<br/>
【修改建议】<br/>
#### 2.2.4浮层弹出后自动朗读所有控件
![](/21.png)<br/>
图21 浮层弹出后自动朗读所有控件【示例】<br/>
【问题描述】<br/>
浮层弹出后会自动把浮层内的所有元素按顺序朗读一遍；<br/>
【可能原因】<br/>
没有给PopupWindow设置背景；<br/>
【修改建议】<br/>
android：<br/>
使用setBackgroundDrawable（）函数设置背景，为了不改变视觉效果可以使用下面的两种方式：<br/>
setBackgroundDrawable(new BitmapDrawable());<br/><br/>
setBackgroundDrawable(new ColorDrawable(0x00000000))。<br/>
### 2.3提示文本

背景描述：<br/>
　　*小朱同学纠结完浮层的问题之后，小朱同学开始滑动浏览界面上，却听到一些“按钮77”“按钮64 未加标签”“按钮99 未加标签”的提示，在选车的时候也没有提示控件类型，无法得知车型是否已选择。提示文本是屏幕阅读器可以提取，并通过语音反馈给用户的说明性文本，包括控件类型、操作目的等内容，要求提示文本简介明了，但有很多控件的控件类型不提示、目的文本为乱码，也有冗余的现象。根据使用经验，小朱同学还是顺利打到车回到家。但是小朱同学希望，更多的互联网产品可以进行无障碍优化。身为视障工程师，小朱不认为是命运不公，却也总希望能为自己公平的享受现代科技带来的便利。*<br/>
#### 2.3.1没有提示文本
![](/22.png)<br/>
图22 没有提示文本【示例】<br/>
【问题描述】<br/>
控件没有提示文本， 用户无法知道此控件是做什么的。 有几种表现：<br/> 1、 控件能获得焦点但是不读任何信息， 如邮箱大师添加邮箱的qq邮箱。<br/> 2、 控件获得焦点只朗读控件类型，如朗读为：”按钮“、 ”x未标记的按钮“（x是一个随机数）。<br/>
【可能原因】<br/>
1、 android<br/>
图形按钮没有添加contentdescription属性；<br/>
2、 ios<br/>
图形按钮没有添加标签或者提示；<br/>
【修改建议】<br/>
1、android：<br/>
给图形按钮添加contentdescription属性并给此属性赋适当的值；<br/>
2、 ios<br/>
给图形按钮添加标签和提示属性；
#### 2.3.2提示文本有乱码
![](/23.png)<br/>
图23 提示文本有乱码【示例】<br/>
【问题描述】<br/>
控件获得焦点的时候， 控件的提示文本朗读为乱码、 朗读控件提示文本之前朗读一段乱码、 提示文本的尾部有一段乱码或者在提示文本中间有乱码。<br/>
【可能原因】<br/>
【修改建议】<br/>
#### 2.3.3控件类型不能正常朗读
![](/24.png)<br/>
图24 空间类型不能正常朗读【示例】<br/>
【问题描述】<br/>
控件的类型不提示或者控件类型提示不正确， 用户不知道如何操作此控件， 这种情况主要出现在自定义控件上；<br/>
【可能原因】<br/>
自定义控件的无障碍支持不全面；<br/>
【修改建议】<br/>
android：<br/>
在任何一种情况下，为您的自定义视图类您应该执行下面的可访问性方法：<br/>
```
dispatchPopulateAccessibilityEvent()
onPopulateAccessibilityEvent()
onInitializeAccessibilityEvent()
onInitializeAccessibilityNodeInfo()```

通常是在onInitializeAccessibilityEvent() 方法中提供类名（控件类型）。<br/>
#### 2.3.4提示文本有冗余信息、 提示文本错误
![](/25.png)<br/>
图25 提示文本有冗余信息【示例】<br/>
【问题描述】<br/>
控件的提示文本有冗余； 控件的提示文本与控件的实际目的不相符；<br/>
【可能原因】<br/>
1.	给控件提供提示文本或替代文本时文本不够精炼准；<br/>
2.	提供了一些不必要的信；<br/>【修改建议】<br/>
1、给控件提供文本或者替代文本时要精炼准确；<br/>
2、去掉这些不必要的信息。<br/>
